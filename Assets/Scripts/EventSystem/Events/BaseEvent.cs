using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// 기초적인 이벤트와 관련된 스크립트
// 최초 작성자 : 이상도
// 수정자: 이상도
// 최종 수정일: 2025-05-03

public abstract class BaseEvent<T>: ScriptableObject
{
    ///////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////
    // Components
    ///////////////////////////////////////////////////////////////
    
    // scriptable Object
    private readonly List<IEventListener<T>> m_EventListeners = new List<IEventListener<T>>();

    ///////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////
    // Event listener call function
    // 안정성을 위한 역순 설계
    // 이벤트 발생시 같은 데이터 객체를 리스너들에게 전달
    ///////////////////////////////////////////////////////////////
    public void Raise(T data)
    {
        for(int i = m_EventListeners.Count - 1; i >= 0; --i)
        {
            m_EventListeners[i].OnEventRaised(data);
        }
    }

    ///////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////
    // Add event listener Function
    ///////////////////////////////////////////////////////////////
    public void AddListner(IEventListener<T> listener) 
    {
        if(!m_EventListeners.Contains(listener)) m_EventListeners.Add(listener);
    }

    ///////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////
    // Remove event listener Function
    ///////////////////////////////////////////////////////////////
    public void RemoveListener(IEventListener<T> listener)
    {
        if (m_EventListeners.Contains(listener)) m_EventListeners.Remove(listener);
    }
}
